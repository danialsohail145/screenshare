<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" href="../public/css/home.css" />
    <link rel="stylesheet" href="../public/css/admindashboard.css" />

    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js"
        integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
    <script src="https://kit.fontawesome.com/84c4a0d090.js" crossorigin="anonymous"></script>
    <script src="../public/js/date.js"></script>
    <script src="../public//js/jquery-3.4.1.min.js"></script>
    <title>Document</title>
</head>

<body>
    <div class="desktop-size">
        <div class="desktop-left">
            <div class="d-left-upper">
                <img src="../public/assets/logo.jpg" width="200px">
                <h3>Screen Sharing</h3>
            </div>
            <!-- Side Menu Admin Changes -->
            <div>
                <div class="input-group rounded">
                    <input type="search" class="form-control rounded" placeholder="Search" aria-label="Search"
                        aria-describedby="search-addon" id="searchuser" />
                    <span class="input-group-text border-0" id="search-addon" onclick="searchdata()">
                        <i class="fas fa-search"></i>
                    </span>
                </div>
            </div>
            <p hidden id=scrpt_get_locals>
                <%= JSON.stringify(users) %>
            </p>
            <div class="container table-c w-75 rounded mt-3 mb-3" style="height:100vh">
                <div class="table-wrapper-scroll-y my-custom-scrollbar">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Users</th>
                                <th>Meeting Id</th>
                            </tr>
                        </thead>
                        <tbody id="userTableBody">
                            <!-- <% for(var i=0; i < users.length; i++) { %>
                                <tr>
                                    <td>
                                        <%= users[i] %>
                                    </td>
                                </tr>
                                <% } %> -->
                        </tbody>
                    </table>
                </div>
            </div>


            <!-- Side Menu Admin Changes Ends-->

            <!-- <div class="d-left-middle"><i class="fa-solid fa-house fa-2x"></i></div>
            <div class="d-left-lower">
                <div class="dropdown">
                    <span class="fa-solid fa-ellipsis fa-2x dropdown-toggle" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false "></span>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                        <li class="d-flex justify-content-evenly align-content-center"><span class="material-icons" style="color:red;">info</span><a class="dropdown-item" style="color:red !important;" href="/about-web">About</a></li>
                        <li class="d-flex"><span class="material-icons" style="color:red;">task</span><a class="dropdown-item" href="/privacy-web " style="color:red !important;">Privacy Policy</a></li>
                    </ul>
                </div>
            </div> -->
        </div>
        <div class="desktop-right">
            <div class="d-right-upper">
                <div class="d-time">
                    <h1><b>12:35 PM</b></h1>
                </div>
                <div class="d-date">
                    <p><b>Thursday, 20th May'22</b></p>
                </div>
                <div class="d-search">
                    <input type="text " placeholder="Enter Remote Id " id="remoteId" />
                    <button type="button ">
                        <button class="btn btn-danger" onclick="getConnected()">Connect</button>
                    </button>
                </div>
                <div class="d-profile-pic">
                    <img src="../public/images/other.jpg" alt="profile-pic" width="40rem" height="40rem" />
                </div>
            </div>
            <div class="d-right-lower">
                <div class="d-right-left">
                    <div class="d-meets">
                        <div class="container" style="background-color: white; border-radius:15px">
                            <table class="table table-striped">
                                <thead>
                                    <th>
                                        Email
                                    </th>

                                    <th>
                                        Username
                                    </th>

                                    <th>
                                        Meeting Id
                                    </th>
                                </thead>
                                <tbody>
                                    <td id="extract-email">

                                    </td>

                                    <td id="extract-username">

                                    </td>

                                    <td id="extract-meetid">

                                    </td>
                                </tbody>
                            </table>
                        </div>

                        <!-- <div class="d-schedule-meet">
                            <div><i class="fa-solid fa-calendar-days fa-2x"></i></div>
                            <div>
                                <h3 style="font-weight: lighter;font-size: 1.17rem;">SCHEDULE MEETING</h3>
                            </div>
                        </div> -->
                    </div>
                </div>
                <!-- <div class="d-right-right">
                    <div class="d-upcoming">
                        <h1 style="font-weight: lighter; color: #db3643;font-size: 2rem;">
                            Upcoming Meetings,
                        </h1>
                        <p>Today</p>
                        <div class="d-meetings">
                            <div class="d-meeting">
                                <div class="img"><img src=" " alt=" " /></div>
                                <div class="name-btn">
                                    <p>Name</p>
                                    <button style="
                        color: white;
                        background-color: #db3643;
                        padding: 0.5rem;
                        border-radius: 0.5rem;
                      ">
                      Start
                    </button>
                                </div>
                                <div class="time-del">
                                    <p style="color: #db3643">02:00 PM</p>
                                    <i class="fa-solid fa-trash-can"></i>
                                </div>
                            </div>
                            <div class="d-meeting">
                                <div class="img"><img src=" " alt=" " /></div>
                                <div class="name-btn">
                                    <p>Name</p>
                                    <button style="
                        color: white;
                        background-color: #db3643;
                        padding: 0.5rem;
                        border-radius: 0.5rem;
                      ">
                      Start
                    </button>
                                </div>
                                <div class="time-del">
                                    <p style="color: #db3643">02:00 PM</p>
                                    <i class="fa-solid fa-trash-can"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
            </div>
        </div>
    </div>
    <div class="mobile-size">
        <div class="mobile-upper">
            <h3>Meet and Share</h3>
            <div class="m-search">
                <input type="text " placeholder="Enter Remote Id " id="remoteIdMobile" />
                <button type="button ">
                    <button class="btn btn-danger" onclick="getConnectedMobile()">Connect</button>
                </button>
            </div>
            <div class="m-search mt-2">
                <input type="text " placeholder="Search " id="searchUserMobile" />
                <button type="button" onclick="searchdataMobile()">
                    <i class="fa-solid fa-magnifying-glass" style="font-size:1.5rem;"></i>
                </button>
            </div>
        </div>
        <p hidden id=scrpt_get_locals>
            <%= JSON.stringify(users) %>
        </p>
        <div class="mobile-middle mt-3">
            <div class="container table-c w-75 rounded mt-3 mb-3" style="height:100vh">
                <div class="table-wrapper-scroll-y my-custom-scrollbar">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Users</th>
                                <th>Meeting Id</th>
                            </tr>
                        </thead>
                        <tbody id="userTableBodyMobile">
                            <!-- <% for(var i=0; i < users.length; i++) { %>
                                <tr>
                                    <td>
                                        <%= users[i] %>
                                    </td>
                                </tr>
                                <% } %> -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="mobile-bottom">
            <div><a href="/home"><i class="fa-solid fa-house" style="font-size:1.5rem;"></i></a></div>
            <div><i class="fa-solid fa-clock" style="font-size:1.5rem;"></i></div>
            <div>
                <a href="/more"><i class="fa-solid fa-ellipsis" style="font-size:1.5rem;"></a></i>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <!-- Modal Ends -->

    <script>
        const renderdUsers = JSON.parse(document.getElementById('scrpt_get_locals').innerText);
        let locals = JSON.parse(document.getElementById('scrpt_get_locals').innerText)
        var tableBody = document.getElementById('userTableBody');
        var tableBodyMobile = document.getElementById('userTableBodyMobile');
        for (var i = 0; i < locals.length; i++) {
            var tr = document.createElement('tr');
            var td = document.createElement('td');
            td.setAttribute('id', `usersEvent`);
            td.appendChild(document.createTextNode(locals[i].name));
            td.onclick = function (ev, val = locals, index = this.innerHTML) {
                for (var x = 0; x < val.length; x++) {
                    if (val[x].name == index) {
                        console.log(val[x]);
                        document.getElementById('extract-email').innerHTML = val[x].email;
                        document.getElementById('extract-username').innerHTML = val[x].name;
                        document.getElementById('extract-meetid').innerHTML = val[x].meetingId;

                    }

                }
            };
            tr.appendChild(td)
            var meettd = document.createElement('td');
            meettd.appendChild(document.createTextNode(locals[i].meetingId));
            tr.appendChild(meettd)
            tableBody.appendChild(tr);

            tableBodyMobile.innerHTML = tableBody.innerHTML;

            // tableBodyMobile.appendChild(tr);
        }

        function getUserDetail(val) {
            console.log(val);
        }

        function searchdata() {
            locals = renderdUsers;
            var searchuser = document.getElementById('searchuser').value;

            var isFound = true;
            var foundedUser;
            for (var i = 0; i < locals.length; i++) {
                if (locals[i].name == searchuser) {
                    console.log(locals[i]);
                    isFound = true;
                    foundedUser = locals[i];
                    break;
                }
                else {
                    isFound = false;
                }
            }
            if (isFound) {
                locals = foundedUser
                console.log(foundedUser);
                console.log(locals);
                var tableBody = document.getElementById('userTableBody');
                var tableBodyMobile = document.getElementById('userTableBodyMobile');

                document.getElementById('userTableBody').innerHTML = '';
                document.getElementById('userTableBodyMobile').innerHTML = '';
                var tr = document.createElement('tr');
                var td = document.createElement('td');
                td.appendChild(document.createTextNode(locals.name));
                td.onclick = function (ev, val = locals, index = this.innerHTML) {
                    console.log(val)
                    document.getElementById('extract-email').innerHTML = val.email;
                    document.getElementById('extract-username').innerHTML = val.name;
                    document.getElementById('extract-meetid').innerHTML = val.meetingId;
                };
                tr.appendChild(td);
                var meettd = document.createElement('td');
                meettd.appendChild(document.createTextNode(locals.meetingId));
                tr.appendChild(meettd)
                tableBody.appendChild(tr);
                tableBody.appendChild(tr);
                tableBodyMobile.innerHTML = tableBody.innerHTML;

            }
            else {
                locals = renderdUsers;
                document.getElementById('userTableBody').innerHTML = '';
                var tableBody = document.getElementById('userTableBody');
                document.getElementById('userTableBodyMobile').innerHTML = '';
                var tableBodyMobile = document.getElementById('userTableBodyMobile');
                for (var i = 0; i < locals.length; i++) {
                    var tr = document.createElement('tr');
                    var td = document.createElement('td');
                    td.appendChild(document.createTextNode(locals[i].name));
                    td.onclick = function (ev, val = locals, index = this.innerHTML) {
                        for (var x = 0; x < val.length; x++) {
                            if (val[x].name == index) {
                                console.log(val[x]);
                                document.getElementById('extract-email').innerHTML = val[x].email;
                                document.getElementById('extract-username').innerHTML = val[x].name;
                                document.getElementById('extract-meetid').innerHTML = val[x].meetingId;

                            }

                        }
                    };
                    tr.appendChild(td);
                    var meettd = document.createElement('td');
                    meettd.appendChild(document.createTextNode(locals[i].meetingId));
                    tr.appendChild(meettd)
                    tableBody.appendChild(tr);
                    tableBody.appendChild(tr);
                    tableBodyMobile.innerHTML = tableBody.innerHTML;

                }
                alert("No User Found")
            }
        }



        function searchdataMobile() {
            locals = renderdUsers;
            var searchuser = document.getElementById('searchUserMobile').value;
            console.log(searchuser);
            var isFound = true;
            var foundedUser;
            for (var i = 0; i < locals.length; i++) {
                if (locals[i].name == searchuser) {
                    console.log(locals[i]);
                    isFound = true;
                    foundedUser = locals[i];
                    break;
                }
                else {
                    isFound = false;
                }
            }
            if (isFound) {
                locals = foundedUser
                console.log(foundedUser);
                console.log(locals);
                var tableBody = document.getElementById('userTableBody');
                var tableBodyMobile = document.getElementById('userTableBodyMobile');

                document.getElementById('userTableBody').innerHTML = '';
                document.getElementById('userTableBodyMobile').innerHTML = '';
                var tr = document.createElement('tr');
                var td = document.createElement('td');
                td.appendChild(document.createTextNode(locals.name));
                td.onclick = function (ev, val = locals, index = this.innerHTML) {
                    console.log(val)
                    document.getElementById('extract-email').innerHTML = val.email;
                    document.getElementById('extract-username').innerHTML = val.name;
                    document.getElementById('extract-meetid').innerHTML = val.meetingId;
                };
                tr.appendChild(td);
                var meettd = document.createElement('td');
                meettd.appendChild(document.createTextNode(locals.meetingId));
                tr.appendChild(meettd)
                tableBody.appendChild(tr);
                tableBody.appendChild(tr);
                tableBodyMobile.innerHTML = tableBody.innerHTML;

            }
            else {
                locals = renderdUsers;
                document.getElementById('userTableBody').innerHTML = '';
                var tableBody = document.getElementById('userTableBody');
                document.getElementById('userTableBodyMobile').innerHTML = '';
                var tableBodyMobile = document.getElementById('userTableBodyMobile');
                for (var i = 0; i < locals.length; i++) {
                    var tr = document.createElement('tr');
                    for (var j = 0; j < 2; j++) {
                        var td = document.createElement('td');
                        td.appendChild(document.createTextNode(locals[i].name));
                    }
                    tr.appendChild(td);
                    var meettd = document.createElement('td');
                    meettd.appendChild(document.createTextNode(locals[i].meetingId));
                    tr.appendChild(meettd)
                    tableBody.appendChild(tr);
                    tableBody.appendChild(tr);
                    tableBodyMobile.innerHTML = tableBody.innerHTML;
                }
                alert("No User Found")
            }
        }

        function getConnected() {
            var remoteId = document.getElementById('remoteId').value;
            var meetingUrl =
                window.location.origin +
                "/meeting" +
                "?meetingID=" +
                remoteId +
                "&name=Admin"
            window.location.replace(meetingUrl);
        }

        function getConnectedMobile() {
            var remoteId = document.getElementById('remoteIdMobile').value;
            var meetingUrl =
                window.location.origin +
                "/participant-mobile" +
                "?meetingID=" +
                remoteId +
                "&name=Admin"
            window.location.replace(meetingUrl);
        }

        // User Data Event
        // $('#usersEvent').click(function () {
        //     console.log(document.getElementById('userTableBody').innerHTML);
        // });


    </script>
    <script>
        var today = new Date();
        // today = today.toDateString();
        var day = today.toString().substr(0, 3);
        var month = today.toString().substr(4, 3);
        var date = today.getDate();
        var year = today.getFullYear() - 2000;
        var sub = "th";
        if (date == 1)
            sub = "st";
        if (date == 2)
            sub = "nd";
        if (date == 3)
            sub = "rd";
        var datetext = day + "," + date + sub + " " + month + "\'" + year;
        var time;
        // console.log(datetext);
        if (today.getMinutes() < 10)
            time =
                today.getHours() + ":" + "0" + today.getMinutes();
        else
            time = today.getHours() + ":" + today.getMinutes();
        document.querySelector(".desktop-right .d-right-upper .d-time b").innerHTML = time;
        document.querySelector(".desktop-right .d-right-upper .d-date b").innerHTML = datetext;
    </script>
</body>

</html>